  - platform: template
    switches:
      source_music:
        friendly_name: Source Music
        value_template: "{{ is_state_attr('remote.harmony', 'current_activity', 'Source music') }}"
        icon_template: >-
          {% if is_state_attr('remote.harmony', 'current_activity', 'Source music') %}
            mdi:music-note
          {% else %}
            mdi:music-note-off
          {% endif %}
        turn_on:
          - service: remote.turn_on
            entity_id: remote.harmony
            data: 
              activity: "Source music"
        turn_off:
          - service: remote.turn_off
            entity_id: remote.harmony
            data:
              activity: "Source music"
  - platform: template
    switches:
      source_movie:
        friendly_name: Source Movie
        #icon: mdi-movie
        value_template: "{{ is_state_attr('remote.harmony', 'current_activity', 'Source movie') }}"
        icon_template: >-
          {% if is_state_attr('remote.harmony', 'current_activity', 'Source movie') %}
            mdi:filmstrip
          {% else %}
            mdi:filmstrip-off
          {% endif %}
        turn_on:
          service: remote.turn_on
          entity_id: remote.harmony
          data: 
            activity: "Source movie"
        turn_off:
          service: remote.turn_off
          entity_id: remote.harmony
          data:
            activity: "Source movie"
  - platform: template
    switches:
      source_chromecast:
        friendly_name: Source Chromecast
        #icon: mdi-google-chrome
        value_template: "{{ is_state_attr('remote.harmony', 'current_activity', 'Source Chromecast') }}"
        icon_template: >-
          {% if is_state_attr('remote.harmony', 'current_activity', 'Source Chromecast') %}
            mdi:google-chrome
          {% else %}
            mdi:google-chrome
          {% endif %}
        turn_on:
          service: remote.turn_on
          entity_id: remote.harmony
          data: 
            activity: "Source Chromecast"
        turn_off:
          service: remote.turn_off
          entity_id: remote.harmony
          data:
            activity: "Source Chromecast" 
  - platform: template
    switches:
      source_games:
        friendly_name: Source Games
        #icon: mdi-gamepad-variant
        value_template: "{{ is_state_attr('remote.harmony', 'current_activity', 'Source games') }}"
        icon_template: >-
          {% if is_state_attr('remote.harmony', 'current_activity', 'Source games') %}
            mdi:xbox-controller
          {% else %}
            mdi:xbox-controller-off
          {% endif %}
        turn_on:
          service: remote.turn_on
          entity_id: remote.harmony
          data: 
            activity: "Source games"
        turn_off:
          service: remote.turn_off
          entity_id: remote.harmony
          data:
            activity: "Source games"
  - platform: template
    switches:
      projector_screen:
        friendly_name: Projector Screen
        #icon: mdi-projector-screen
        value_template: "{{ is_state_attr('remote.harmony', 'current_activity', 'Screen') }}"
        icon_template: >-
          {% if is_state_attr('remote.harmony', 'current_activity', 'Screen') %}
            mdi:projector-screen
          {% else %}
            mdi:projector-screen
          {% endif %}
        turn_on:
          service: remote.turn_on
          entity_id: remote.harmony
          data: 
            activity: "Screen"
        turn_off:
          service: remote.turn_off
          entity_id: remote.harmony
          data:
            activity: "Screen"
  - platform: template
    switches:
      watch_movie:
        friendly_name: Watch movie
        #icon: mdi-theater
        value_template: "{{ is_state_attr('remote.harmony', 'current_activity', 'Watch movie') }}"
        icon_template: >-
          {% if is_state_attr('remote.harmony', 'current_activity', 'Watch movie') %}
            mdi:theater
          {% else %}
            mdi:theater
          {% endif %}
        turn_on:
          - service: remote.turn_on
            entity_id: remote.harmony
            data: 
              activity: "Watch movie"
        turn_off:
          - service: remote.turn_off
            entity_id: remote.harmony
            data:
              activity: "Watch movie"
  - platform: template
    switches:
      projector:
        friendly_name: Projector
        #icon: mdi-theater
        value_template: "{{ is_state_attr('remote.harmony', 'current_activity', 'Projector') }}"
        icon_template: >-
          {% if is_state_attr('remote.harmony', 'current_activity', 'Projector') %}
            mdi:projector
          {% else %}
            mdi:projector
          {% endif %}
        turn_on:
          service: remote.turn_on
          entity_id: remote.harmony
          data: 
            activity: "Projector"
        turn_off:
          service: remote.turn_off
          entity_id: remote.harmony
          data:
            activity: "Projector"
  - platform: template
    switches:
      test:
        value_template: "{{ is_state('remote.harmony', 'Source music') }}"
        turn_on:
          service: remote.send_command
          entity_id: remote.harmony
          data: 
            device: "51912683"
            command: "PowerOn"
        turn_off:
          service: remote.send_command
          entity_id: remote.harmony
          data: 
            device: "51912683"
            command: "PowerOff"